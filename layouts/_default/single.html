{{- define "main" }}

<article class="post-single">
  <header class="post-header">
    {{ partial "breadcrumbs.html" . }}
    <h1 class="post-title">
      {{ .Title }}
      {{- if .Draft }}<sup><span class="entry-isdraft">&nbsp;&nbsp;[draft]</span></sup>{{- end }}
    </h1>
    {{- if .Description }}
    <div class="post-description">
      {{ .Description }}
    </div>
    {{- end }}
    {{- if not (.Param "hideMeta") }}
    <div class="post-meta">
      {{- partial "post_meta.html" . -}} <!--åœ¨è¿™é‡Œå¼•ç”¨å¤´éƒ¨ä¿¡æ¯-->
      <!-- åˆ—è¡¨é¡µ è¿½åŠ è®¡æ•°ç›¸å…³ä¿¡æ¯ -->
      <span style="opacity: 0.8;">
        <span id="post_meta_style_7">
            &nbsp;&nbsp;
            <span class="fa fa-eye" ></span>
            <span>
                <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv"></span></span>
                &nbsp;&nbsp;
            </span>
        </span>
        <span id="post_meta_style_8">
            <span class="fa fa-commenting-o"></span>
            <span>
                <script src="https://cdn.staticfile.org/twikoo/{{ .Site.Params.twikoo.version }}/twikoo.all.min.js"></script>
                <script>
                    let url = document.documentURI
                    {{ $baseURL := .Site.BaseURL }}
                    let dnsUrl = {{ $baseURL }}
                    let urlSplit = url.split(dnsUrl)
                    let finalUrl = urlSplit[1]
                    if (finalUrl[0] !== '/') {
                        finalUrl = '/'+finalUrl
                    }
                    twikoo.getCommentsCount({
                    envId: {{ .Site.Params.twikoo.id }}, // ç¯å¢ƒ ID
                    region: {{ .Site.Params.twikoo.region }}, // ç¯å¢ƒåœ°åŸŸï¼Œé»˜è®¤ä¸º ap-shanghaiï¼Œå¦‚æœæ‚¨çš„ç¯å¢ƒåœ°åŸŸä¸æ˜¯ä¸Šæµ·ï¼Œéœ€ä¼ æ­¤å‚æ•°
                    urls: [ // ä¸åŒ…å«åè®®ã€åŸŸåã€å‚æ•°çš„æ–‡ç« è·¯å¾„åˆ—è¡¨ï¼Œå¿…ä¼ å‚æ•°
                        // '/2020/10/post-1.html', //å¡«å†™ç¤ºä¾‹
                        finalUrl,
                    ],
                        includeReply: false // è¯„è®ºæ•°æ˜¯å¦åŒ…æ‹¬å›å¤ï¼Œé»˜è®¤ï¼šfalse
                    }).then(function (res) {
                        let count = res[0].count
                        const obj = document.getElementById("comment_count");
                        obj.innerText = count
                        // è¿”å›ç¤ºä¾‹: [
                        //   { url: '/2020/10/post-1.html', count: 10 },
                        // ]
                    }).catch(function (err) {
                        // å‘ç”Ÿé”™è¯¯
                        console.error(err);
                    });
                </script>
                <span id="comment_count"></span>
            </span>
        </span>
      </span>
      
      {{- partial "translation_list.html" . -}}
      {{- partial "edit_post.html" . -}}
      {{- partial "post_canonical.html" . -}}
    </div>
    {{- end }}
  </header>
  {{- $isHidden := .Params.cover.hidden | default site.Params.cover.hiddenInSingle | default site.Params.cover.hidden }}
  
  <!-- æ³¨é‡Š:åˆ—è¡¨æ–‡ç« å°é¢è°ƒç”¨çš„æ˜¯ç»è¿‡ä¿®æ”¹çš„å›¾ç‰‡cover1.htmlæ ·å¼entry-cover1ï¼Œè€Œæ–‡ç« é‡Œé¢é¡¶éƒ¨çš„å›¾ç‰‡è°ƒç”¨çš„æ˜¯æœªç»ä¿®æ”¹çš„å›¾ç‰‡cover.htmlçš„æ ·å¼entry-cover -->
  <!-- {{- partial "cover.html" (dict "cxt" . "IsHome" false "isHidden" $isHidden) }} -->
  {{- partial "cover1.html" (dict "cxt" . "IsHome" false "isHidden" $isHidden) }}
  <!--è°ƒç”¨tocä¾§è¾¹ç›®å½•-->
  {{- if (.Param "ShowToc") }}
  {{- partial "toc.html" . }}
  {{- end }}

  {{- if .Content }}
  <div class="post-content">
    {{- if not (.Param "disableAnchoredHeadings") }}
    {{- partial "anchored_headings.html" .Content -}}
    {{- else }}{{ .Content }}{{ end }}
  </div>
  {{- end }}

  <!--è‡ªå®šä¹‰å¢åŠ çš„æ‰“èµæŒ‰é’®-->
  {{- if .Param "reward" }}
  <div class="post-reward">
      <div style="padding: 0 0 0 0; margin: 0 0 0 0; width: 100%; font-size:16px; text-align: center;">
          <div id="QR" style="opacity: 0;">
              <div id="wechat" style="display: inline-block">
                  <a class="fancybox" rel="group">
                      <img id="wechat_qr" src="{{ .Site.Params.WechatPay | absURL }}" alt="wechat_pay"></a>
                  <p>å¾®ä¿¡</p>
              </div>
              <div id="alipay" style="display: inline-block">
                  <a class="fancybox" rel="group">
                      <img id="alipay_qr" src="{{ .Site.Params.Alipay | absURL }}" alt="alipay"></a>
                  <p>æ”¯ä»˜å®</p>
              </div>
          </div>
          <button id="rewardButton"
                  onclick="
              var qr = document.getElementById('QR');
              if (qr.style.opacity === '0') {
                  qr.style.opacity='1';
              } else {
                  qr.style.opacity='0'
              }"
          >
              <span>ğŸ§§ é¼“åŠ±</span>
          </button>
      </div>
  </div>
  {{- end }}
  
  <footer class="post-footer">
    {{- $tags := .Language.Params.Taxonomies.tag | default "tags" }}
    <ul class="post-tags">
      {{- range ($.GetTerms $tags) }}
      <li><a href="{{ .Permalink }}">{{ .LinkTitle }}</a></li>
      {{- end }}
    </ul>
    {{- if (.Param "ShowPostNavLinks") }}
    {{- partial "post_nav_links.html" . }}
    {{- end }}
    {{- if (and site.Params.ShowShareButtons (ne .Params.disableShare true)) }}
    {{- partial "share_icons.html" . -}}
    {{- end }}
  </footer>
<!-- twikooï¼Œä»¥ä¸‹3è¡Œä»£ç è°ƒç”¨è¯„è®ºhtml -->
  {{- if (.Param "comments") }}
  {{- partial "comments.html" . }}
  {{- end }}
</article>

{{- end }}{{/* end main */}}
